import matplotlib.pyplot as plt

# Новые данные
B = [
    1.543404479, 1.351132018, 1.296794149, 1.238276444, 1.209017591, 1.18811841,
    1.160949476, 1.137960377, 1.10243177, 1.062723328, 1.014655212, 0.908069392,
    0.7095271774, 0.4232084048, 0.1703283209, -0.1180803697, -0.304083076,
    -0.517254717, -0.8035734896, -0.9770366876, -1.286344559, -1.555943987,
    -1.298884067, -1.108701525, -1.046003983, -0.9895761959, -0.9603173432,
    -0.9415080808, -0.9164290642, -0.8955298837, -0.8600012769, -0.8182029159,
    -0.7701348008, -0.6614590623, -0.4587370116, -0.1786879931, 0.07419209071,
    0.3646906994, 0.5527833238, 0.7680448827, 1.043914065, 1.219467181, 1.526685134,
    1.792104726
]

H = [
    5.24399622, 3.256469291, 2.714467132, 2.217975329, 1.97699883, 1.804817055,
    1.58194443, 1.369544201, 1.036989947, 0.6115767421, 0, -0.6112425167,
    -1.036321496, -1.369544201, -1.585063867, -1.803925787, -1.418006881,
    -2.213797512, -2.702379314, -3.250898868, -5.234526501, -9.606194478,
    -5.240653966, -3.254241121, -2.712796005, -2.215691456, -1.975940449,
    -1.804705646, -1.581443092, -1.369767018, -1.036655722, -0.6116324463,
    0, 0.6112425167, 1.036265792, 1.369544201, 1.57943774, 1.803925787,
    1.974937773, 2.213518991, 2.702936356, 3.25145591, 5.235083543, 9.617335324
]

# Погрешности
sigma_B = [
    0, 0.02726531007, 0.04767066602, 0.05352386306, 0.05981345297, 0.06308586643,
    0.06553503868, 0.06859835932, 0.07124954978, 0.07515745712, 0.07949386389, 0.08469457083,
    0.09603962012, 0.1171086506, 0.1474730035, 0.1742956318, 0.2048813608,
    0.224623099, 0.2472408963, 0.2776052492, 0.296019947, 0.3288195334,
    0.3574129504, 0.02018414345, 0.02691099171, 0.03298226533, 0.03625467879,
    0.03850550279, 0.04136160276, 0.04381077501, 0.04771868235, 0.05227038102,
    0.05747108796, 0.06903671997, 0.09054822915, 0.1202484655, 0.1470710938,
    0.1778782007, 0.1978411382, 0.2206802076, 0.2499377097, 0.2685735611,
    0.3011517544, 0.3293024593
]

sigma_H = [
    0.02636749537, 0.01651884406, 0.01385516865, 0.01143428035, 0.01026988376, 0.009444126119,
    0.008385768159, 0.007392474963, 0.005885669621, 0.004136188573, 0, 0.004134953262,
    0.005882725493, 0.007392474963, 0.008400481515, 0.009439868074, 0.007617479306,
    0.01141402158, 0.01379596869, 0.01649139137, 0.02632041214, 0.04811165879,
    0.02635087765, 0.01650786282, 0.01384698369, 0.01142320528, 0.01026479029,
    0.009443593853, 0.008383403811, 0.007393506962, 0.005884197504, 0.004136394488,
    0, 0.004134953262, 0.005882480168, 0.007392474963, 0.008373947245,
    0.009439868074, 0.01025996507, 0.01141267108, 0.01379869656, 0.01649413658,
    0.02632318172, 0.04816726971
]

# Построение графика с точками
plt.figure(figsize=(10, 6))
plt.errorbar(H[:12], B[:12], yerr=sigma_B[:12], xerr=sigma_H[:12], fmt='o', color='blue', capsize=3, label='Загружение')  # Путь вперед
plt.errorbar(H[12:], B[12:], yerr=sigma_B[12:], xerr=sigma_H[12:], fmt='o', color='red', capsize=3, label='Разгружение')  # Путь назад
plt.title('График гистерезиса B(H) с погрешностями')
plt.xlabel('Магнитная напряженность H (кА/м)')
plt.ylabel('Магнитное поле B (Тл)')
plt.axhline(0, color='black', linewidth=0.5, linestyle='--')
plt.axvline(0, color='black', linewidth=0.5, linestyle='--')
plt.grid()
plt.legend()
plt.show()

